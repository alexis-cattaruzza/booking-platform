<div class="user-menu-container">
  <!-- User Profile Bubble -->
  <button
    class="user-profile-bubble"
    (click)="toggleMenu()"
    [class.active]="isOpen"
    type="button"
  >
    <div class="avatar">
      <span class="initials">{{ userInitials }}</span>
    </div>
    <svg
      class="chevron"
      [class.rotate]="isOpen"
      width="20"
      height="20"
      viewBox="0 0 20 20"
      fill="currentColor"
    >
      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
    </svg>
  </button>

  <!-- Dropdown Menu -->
  <div class="dropdown-menu" [class.show]="isOpen">
    <div class="dropdown-header">
      <div class="user-info">
        <div class="avatar-large">
          <span class="initials">{{ userInitials }}</span>
        </div>
        <div class="details">
          <p class="business-name">{{ businessName }}</p>
          <p class="email">{{ userEmail }}</p>
        </div>
      </div>
    </div>

    <div class="dropdown-divider"></div>

    <div class="dropdown-body">
      <!-- GDPR / Données personnelles -->
      <button
        class="menu-item"
        (click)="navigateTo('/business/gdpr')"
        type="button"
      >
        <svg class="icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"/>
        </svg>
        <div class="menu-item-content">
          <span class="title">Données & Confidentialité</span>
          <span class="subtitle">RGPD, export, suppression</span>
        </div>
      </button>

      <!-- Reset Password -->
      <button
        class="menu-item"
        (click)="navigateTo('/business/reset-password')"
        type="button"
      >
        <svg class="icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M18 8a6 6 0 01-7.743 5.743L10 14l-1 1-1 1H6v2H2v-4l4.257-4.257A6 6 0 1118 8zm-6-4a1 1 0 100 2 2 2 0 012 2 1 1 0 102 0 4 4 0 00-4-4z" clip-rule="evenodd"/>
        </svg>
        <div class="menu-item-content">
          <span class="title">Changer le mot de passe</span>
          <span class="subtitle">Sécurité du compte</span>
        </div>
      </button>

      <div class="dropdown-divider"></div>

      <!-- Logout -->
      <button
        class="menu-item logout"
        (click)="logout()"
        type="button"
      >
        <svg class="icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M3 3a1 1 0 00-1 1v12a1 1 0 001 1h12a1 1 0 001-1V4a1 1 0 00-1-1H3zm11 4.414l-4.293 4.293a1 1 0 01-1.414 0L4 7.414V13h10V7.414z" clip-rule="evenodd"/>
        </svg>
        <span class="title">Se déconnecter</span>
      </button>
    </div>
  </div>
</div>
